!function(e){function t(t){for(var n,a,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)a=r[u],s[a]&&p.push(s[a][0]),s[a]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);p.length;)p.shift()();return i.push.apply(i,c||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,r=1;r<o.length;r++){var l=o[r];0!==s[l]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=o[0]))}return e}var n={},s={0:0},i=[];function a(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=n,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;i.push([1,1]),o()}([,function(e,t,o){agGrid.initialiseAgGridWithAngular1(angular),$('[data-toggle="popover"]').popover();var n=angular.module("subsonic",["ngRoute","ngSanitize","agGrid"]);n.config(["$routeProvider","$locationProvider",function(e,t){$(".content").css("display","none"),$(".loader").css("display","block"),e.when("/",{templateUrl:"template/home.jade",controller:"homeController"}).when("/status",{templateUrl:"template/status.jade",controller:"statusController"}).when("/index",{templateUrl:"template/index-view.jade",controller:"indexController"}).when("/starred",{templateUrl:"template/starred.jade",controller:"starredController"}).when("/playlist",{templateUrl:"template/playlist.jade",controller:"playlistController"}).when("/playlists",{templateUrl:"template/playlists.jade",controller:"playlistsController"}).when("/genres",{templateUrl:"template/genres.jade",controller:"genresController"}).when("/genre/:id",{templateUrl:"template/genre.jade",controller:"genreController"}).when("/podcasts",{templateUrl:"template/podcasts.jade",controller:"podcastsController"}).when("/playing",{templateUrl:"template/playing.jade",controller:"playingController"}).when("/settings",{templateUrl:"template/settings.jade",controller:"settingsController"}).when("/artists",{templateUrl:"template/artists.jade",controller:"artistsController"}).when("/artist/:id",{templateUrl:"template/artist.jade",controller:"artistController"}).otherwise({redirectTo:"/"}),t.html5Mode({enabled:!0,requireBase:!1}).hashPrefix("")}]),n.factory("media",function(e){return e[0].getElementById("media-player")}),n.run(function(e,t,o,n,s){angular.element(e).on("__onGCastApiAvailable",function(e){console.log("cast is "+e),t.isCastAvailable=e}),t.isLoggedIn=!1,t.activeSong="",t.playing=!1,t.currentVolume=o.volume,t.selectedIndex=0,t.repeatEnabled=!1,t.tracks=[],t.settings=[],t.castSession=function(){return cast.framework.CastContext.getInstance().getCurrentSession()},t.trackCount=function(){return t.tracks.length},t.showTrackCount=function(){return t.tracks.length>0},t.selectedTrack=function(){return t.tracks[t.selectedIndex]},t.audioSource=function(){return t.selectedTrack()},t.remotePlayerConnected=function(){return!!t.remotePlayer&&t.remotePlayer.isConnected},t.loadTrack=function(e){t.selectedIndex=e,console.log("loadTrack"),$("#mainTimeDisplay").html("Loading...");var n=t.audioSource();n.artistUrl="/artist/"+n.artistId,n.albumUrl="/album/"+n.albumId,n&&n.id?(n.url=t.subsonic.streamUrl(n.id,320),n.artistId?t.subsonic.getArtistInfo2(n.artistId,50).then(function(e){if(console.log("getArtistDetails result"),e)if(t.remotePlayerConnected()){t.setupRemotePlayer();var s=new chrome.cast.media.MediaInfo(n.url,n.transcodedContentType);s.metadata=new chrome.cast.media.GenericMediaMetadata,s.metadata.metadataType=chrome.cast.media.MetadataType.MUSIC_TRACK,s.customData=JSON.stringify(n),s.metadata.title=n.title,s.metadata.images=[{url:e.largeImageUrl.replace("300x300","1280x400")}];var i=new chrome.cast.media.LoadRequest(s);cast.framework.CastContext.getInstance().getCurrentSession().loadMedia(i)}else{console.log(n),o.src=n.url,o.load(),t.shouldSeek&&(t.shouldSeek=!1,o.currentTime=t.prePlannedSeek);var a=o.play();void 0!==a&&a.then(o=>{console.log("success playing"),$("#artistInfo").html(n.artist),$("#artistInfo").attr("href",n.artistUrl),$("#trackInfo").html(n.title),$("#trackInfo").attr("href","/playing"),n.starred?($("#likeButtonIcon").removeClass("far"),$("#likeButtonIcon").addClass("fa")):($("#likeButtonIcon").removeClass("fa"),$("#likeButtonIcon").addClass("far")),$("#playPauseIcon").addClass("fa-pause"),$("#playPauseIcon").removeClass("fa-play"),$("#nowPlayingImageHolder").attr("src",e.smallImageUrl),$("#volumeSlider").val(100*t.currentVolume),t.$broadcast("trackChangedEvent"),t.$digest()}).catch(e=>{console.log("playing failed "+e)})}}):t.next()):t.next()},t.play=function(){if(t.remotePlayerConnected())t.remotePlayer.isPaused&&t.remotePlayerController.playOrPause();else{var e=o.play();void 0!==e&&e.then(e=>{console.log("success playing")}).catch(e=>{console.log("playing failed "+e)})}},t.pause=function(){t.remotePlayerConnected()?t.remotePlayer.isPaused||t.remotePlayerController.playOrPause():o.pause()},t.stop=function(){o.stop()},t.previous=function(){t.selectedIndex--,t.selectedIndex=t.selectedIndex<0?t.tracks.length-1:t.selectedIndex,t.loadTrack(t.selectedIndex)},t.next=function(){t.repeatEnabled||t.selectedIndex++,t.selectedIndex=t.selectedIndex>=t.tracks.length?0:t.selectedIndex,t.loadTrack(t.selectedIndex)},t.formatTime=function(e){return minutes=Math.floor(e/60),minutes=minutes>=10?minutes:"0"+minutes,e=(e=Math.floor(e%60))>=10?e:"0"+e,minutes+":"+e},$("#media-player").on("error",function(e){switch(console.log("player error "+e.target.error),e.target.error.code){case e.target.error.MEDIA_ERR_ABORTED:alert("You aborted the video playback.");break;case e.target.error.MEDIA_ERR_NETWORK:alert("A network error caused the audio download to fail.");break;case e.target.error.MEDIA_ERR_DECODE:alert("The audio playback was aborted due to a corruption problem or because the video used features your browser did not support.");break;case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:alert("The video audio not be loaded, either because the server or network failed or because the format is not supported.");break;default:alert("An unknown error occurred.")}}),t.setContentBackground=function(e){$(".content").css("background-image","url("+e+")")},t.resetContentBackground=function(e){$(".content").css("background-image",'url("")')},$("#media-player").on("play",function(){t.$apply(function(){t.playing=!0,$("#playPauseIcon").addClass("fa-pause"),$("#playPauseIcon").removeClass("fa-play")})}),$("#media-player").on("pause",function(){t.$apply(function(){t.playing=!1,$("#playPauseIcon").removeClass("fa-pause"),$("#playPauseIcon").addClass("fa-play")})}),$("#media-player").on("ended",function(){t.selectedIndex+1===t.tracks.length?(t.playing=!1,t.selectedIndex=0,$("#media-player").src=t.audioSource(),$("#playPauseIcon").removeClass("fa-pause"),$("#playPauseIcon").addClass("fa-play"),$("#subProgress").attr("aria-valuenow",0).css("width","0%"),$("#mainProgress").attr("aria-valuenow",0).css("width","0%"),$("#mainTimeDisplay").html("")):(t.playing=!0,t.next())}),$("#media-player").on("canplaythrough",function(){$("#mainTimeDisplay").html("0:00 / "+t.formatTime(o.duration)),$("#subProgress").attr("aria-valuenow",0).css("width","0%"),$("#mainProgress").attr("aria-valuenow",0).css("width","0%"),$("#playPauseIcon").addClass("fa-pause"),$("#playPauseIcon").removeClass("fa-play")}),$("#media-player").on("timeupdate",function(){var e=o.duration;isFinite(e)||(e=t.selectedTrack().duration);var n=o.currentTime/e*100;if(!isNaN(n)){var s,i=o.buffered;i.length&&(s=100*i.end(0)/e),$("#subProgress").attr("aria-valuenow",s).css("width",s+"%"),$("#mainProgress").attr("aria-valuenow",n).css("width",n+"%"),$("#mainTimeDisplay").html(t.formatTime(o.currentTime)+" / "+t.formatTime(e))}}),$("#muteButton").click(function(){var e=0;t.remotePlayerConnected()?(t.remotePlayerController.muteOrUnmute(),t.isMuted=t.remotePlayer.isMuted,t.isMuted?(e=0,$("#volumeSlider").val(e)):(e=t.remotePlayer.volumeLevel,$("#volumeSlider").val(100*e))):(t.isMuted=!t.isMuted,t.isMuted?(o.volume=0,$("#volumeSlider").val(0)):(o.volume=t.currentVolume,$("#volumeSlider").val(100*t.currentVolume)))}),$("#skipBackButton").click(function(){t.previous()}),$("#playPauseButton").click(function(){t.remotePlayerConnected()?t.remotePlayer.isPaused?t.play():t.pause():t.playing?t.pause():t.play()}),$("#skipNextButton").click(function(){t.next()}),$("#repeatButton").click(function(){t.repeatEnabled=!t.repeatEnabled,$("#repeatButton").toggleClass("button-selected")}),$("#downloadButton").click(function(){var e=t.subsonic.downloadUrl(t.selectedTrack().id);window.open(e,"_blank")}),$("#likeButton").click(function(){console.log("liking track"),console.log(t.selectedTrack()),t.selectedTrack().starred?t.subsonic.unstar(t.selectedTrack().id).then(function(e){console.log("UnStarred"),t.selectedTrack().starred=void 0,console.log(e),$("#likeButtonIcon").addClass("far"),$("#likeButtonIcon").removeClass("fa")}):t.subsonic.star(t.selectedTrack().id).then(function(e){console.log("starred"),t.selectedTrack().starred=1,$("#likeButtonIcon").removeClass("far"),$("#likeButtonIcon").addClass("fa"),console.log(e)})}),t.fallbackCopyTextToClipboard=function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();try{var o=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+o)}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)},t.copyTextToClipboard=function(e){navigator.clipboard?navigator.clipboard.writeText(e).then(function(){console.log("Async: Copying to clipboard was successful!")},function(e){console.error("Async: Could not copy text: ",e)}):t.fallbackCopyTextToClipboard(e)},$("#shareButton").click(function(){console.log("shareButton"),t.subsonic.createShare(t.selectedTrack().id,"Shared from MediaCenterUI").then(function(e){$("#shareButton").popover({animation:!0,content:"Success! Url Copied to Clipboard.",delay:{show:0,hide:5e3},placement:"top"}).popover("show");var o=e.url.toString();t.copyTextToClipboard(o),setTimeout(()=>{$("#shareButton").popover("hide")},5e3)})}),$("#volumeSlider").on("change",function(){}),$("#volumeSlider").on("input change",function(){var e=t.currentVolume=$("#volumeSlider").val()/100;t.remotePlayerConnected()?(t.remotePlayer.volumeLevel=e,t.remotePlayerController.setVolumeLevel()):o.volume=e}),$("#clickProgress").click(function(e){var n=NaN;if(t.remotePlayerConnected()){NaN!=(n=t.remotePlayer.duration*(e.offsetX/$("#clickProgress").width()))&&(t.remotePlayer.currentTime=n,t.remotePlayerController.seek())}else{var s=o.duration;isFinite(s)||(s=t.selectedTrack().duration),NaN!=(n=s*(e.offsetX/$("#clickProgress").width()))&&(o.currentTime=n)}}),t.socket=io("//"+document.location.hostname+":"+document.location.port),t.socket.on("ping",function(e){e&&$("#ping").html("<code>Connected: "+JSON.parse(e).date+"</code>")}),t.socket.on("settings_event",function(e){if(e){console.log("settings event");var o=e[0];o&&(t.settings={subsonic_username:o.subsonic_username,subsonic_password:o.subsonic_password,subsonic_address:o.subsonic_address,subsonic_port:o.subsonic_port,subsonic_use_ssl:o.subsonic_use_ssl,subsonic_include_port_in_url:o.subsonic_include_port_in_url},t.$broadcast("settingsReloadedEvent"),t.$digest(),s.login())}}),$("#body-row .collapse").collapse("hide"),$("#collapse-icon").addClass("fa-angle-double-left"),$("[data-toggle=sidebar-colapse]").click(function(){t.SidebarCollapse()}),t.SidebarCollapse=function(){t.isMenuCollapsed=!t.isMenuCollapsed,$(".menu-collapsed").toggleClass("d-none"),$(".sidebar-submenu").toggleClass("d-none"),$(".submenu-icon").toggleClass("d-none"),$(".list-group").toggleClass("card-5"),$("#sidebar-container").toggleClass("sidebar-expanded sidebar-collapsed");var e=$(".sidebar-separator-title");e.hasClass("d-flex")?e.removeClass("d-flex"):e.addClass("d-flex"),$("#collapse-icon").toggleClass("fa-angle-double-left fa-angle-double-right"),t.isMenuCollapsed?($(".content").removeClass("content-wide"),$(".gridContainer").removeClass("dataTable-wide")):($(".content").addClass("content-wide"),$(".gridContainer").addClass("dataTable-wide")),t.$broadcast("menuSizeChange")},$("#subProgress").attr("aria-valuenow",0).css("width","0%"),$("#mainProgress").attr("aria-valuenow",0).css("width","0%"),t.socket.emit("load_settings");var i=function(e,t,o){var n;return function(){var s=this,i=arguments,a=o&&!n;clearTimeout(n),n=setTimeout(function(){n=null,o||e.apply(s,i)},t),a&&e.apply(s,i)}}(function(){t.$broadcast("windowResized")},25);$(window).on("resize",i),t.remoteUpdateInfo=function(){if(t.remotePlayerConnected()){var e=t.remotePlayer.currentTime,o=t.remotePlayer.duration,n=e/o*100;isNaN(n)||($("#subProgress").attr("aria-valuenow","100").css("width","100%"),$("#mainProgress").attr("aria-valuenow",n).css("width",n+"%"),$("#mainTimeDisplay").html(t.formatTime(e)+" / "+t.formatTime(o)))}},t.startProgressTimer=function(){t.stopProgressTimer(),t.timer=setInterval(t.remoteUpdateInfo,250)},t.stopProgressTimer=function(){t.timer&&(clearInterval(t.timer),t.timer=null)},Object.defineProperty(HTMLMediaElement.prototype,"playing",{get:function(){return!!(this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2)}}),t.setupRemotePlayer=function(){t.remoteConfigured||(t.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED,function(){t.remotePlayer.isPaused?($("#playPauseIcon").addClass("fa-play"),$("#playPauseIcon").removeClass("fa-pause")):($("#playPauseIcon").addClass("fa-pause"),$("#playPauseIcon").removeClass("fa-play"))}),t.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,function(){t.isMuted=t.remotePlayer.isMuted,t.isMuted?(vol=0,$("#volumeSlider").val(vol)):(vol=t.remotePlayer.volumeLevel,$("#volumeSlider").val(100*vol))}),t.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,function(){$("#volumeSlider").val(100*t.remotePlayer.volumeLevel)}),t.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED,function(){console.log("state change "),console.log(t.remotePlayer.playerState),null===t.remotePlayer.playerState&&(t.remotePlayer.savedPlayerState?(t.shouldSeek=!0,t.prePlannedSeek=t.remotePlayer.savedPlayerState.currentTime,t.loadTrack(t.selectedIndex),console.log("saved state")):t.next()),"BUFFERING"===t.remotePlayer.playerState&&$("#mainTimeDisplay").html("Buffering..."),"PLAYING"===t.remotePlayer.playerState&&t.shouldSeek&&(t.shouldSeek=!1,t.remotePlayer.currentTime=t.prePlannedSeek,t.remotePlayerController.seek()),o.playing&&(t.shouldSeek=!0,t.prePlannedSeek=o.currentTime,o.pause(),t.loadTrack(t.selectedIndex)),t.isMuted=t.remotePlayer.isMuted,t.isMuted?$("#volumeSlider").val(0):$("#volumeSlider").val(100*t.remotePlayer.volumeLevel),t.remotePlayer.isPaused?($("#playPauseIcon").addClass("fa-play"),$("#playPauseIcon").removeClass("fa-pause")):($("#playPauseIcon").addClass("fa-pause"),$("#playPauseIcon").removeClass("fa-play")),t.remotePlayer.mediaInfo&&t.remotePlayer.mediaInfo.metadata}),t.startProgressTimer(),t.remoteConfigured=!0),t.remotePlayerConnected()&&o.playing&&(t.shouldSeek=!0,t.prePlannedSeek=o.currentTime,o.pause(),t.loadTrack(t.selectedIndex))},t.setupLocalPlayer=function(){t.stopProgressTimer(),t.remoteConfigured=!1},t.switchPlayer=function(){console.log("switchPlayer"),cast&&cast.framework&&t.remotePlayerConnected()?t.setupRemotePlayer():t.setupLocalPlayer()},setTimeout(()=>{n.castStatus()&&n.initializeCast()},1e3)}),o(2),o(6)},function(e,t,o){"use strict";var n=o(0);n.module("subsonic").controller("chromecastService",o(4)),n.module("subsonic").controller("subsonicService",o(5))},,function(e,t,o){"use strict";function n(e,t,o,n){var s=!1;return window.__onGCastApiAvailable=function(e){console.log("cast status "+e),s=e},{castStatus:function(){return s},initializeCast:function(e){if(s){var o={receiverApplicationId:"DAB06F7C"};o.autoJoinPolicy=chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,cast.framework.CastContext.getInstance().setOptions(o),t.remotePlayer=new cast.framework.RemotePlayer,t.remotePlayerController=new cast.framework.RemotePlayerController(t.remotePlayer),t.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,t.switchPlayer),t.castSession=cast.framework.CastContext.getInstance().getCurrentSession()}}}}n.$inject=["$http","$rootScope","$route","$window"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o){e.isLoggingIn=!0,e.isLoggedIn=!1;var n=function(){if(e.settings&&e.settings.subsonic_username&&e.settings.subsonic_password&&!e.isLoggedIn){console.log("logging into subsonic");var t=e.settings.subsonic_address;!0===e.settings.subsonic_include_port_in_url&&(t=":"+e.settings.subsonic_port),e.subsonic=new SubsonicAPI({https:e.settings.subsonic_use_ssl,ip:t,port:e.settings.subsonic_port,user:e.settings.subsonic_username,password:CryptoJS.AES.decrypt(e.settings.subsonic_password.toString(),"12345").toString(CryptoJS.enc.Utf8),appName:"MediaServerUI",md5Auth:!0}),document.addEventListener("subsonicApi-ready",t=>{"ok"===t.detail.status?(console.log("connected to subsonic"),e.isLoggingIn=!1,e.isLoggedIn=!0):(console.log("failed to connect to subsonic"),e.isLoggingIn=!1,e.isLoggedIn=!1),e.$broadcast("loginStatusChange",e.isLoggedIn)})}};return{login:n,ping:function(){return n(),!!e.isLoggedIn&&e.subsonic.ping()}}}n.$inject=["$http","$rootScope","$route","$window"],e.exports=n},function(e,t,o){"use strict";var n=o(0);n.module("subsonic").controller("artistController",o(7)),n.module("subsonic").controller("artistsController",o(8)),n.module("subsonic").controller("genreController",o(9)),n.module("subsonic").controller("genresController",o(10)),n.module("subsonic").controller("homeController",o(11)),n.module("subsonic").controller("indexController",o(12)),n.module("subsonic").controller("playingController",o(13)),n.module("subsonic").controller("playlistController",o(14)),n.module("subsonic").controller("playlistsController",o(15)),n.module("subsonic").controller("podcastsController",o(16)),n.module("subsonic").controller("settingsController",o(17)),n.module("subsonic").controller("starredController",o(18)),n.module("subsonic").controller("statusController",o(19))},function(e,t,o){"use strict";function n(e,t,o,n){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("artist-controller"),t.artist={},t.albums=[],t.tracks=[],t.artistName="";t.gridOptions={columnDefs:[{headerName:"#",field:"track",width:75,suppressSizeToFit:!0},{headerName:"Title",field:"title"},{headerName:"Album",field:"album"},{headerName:"Title",field:"title"},{headerName:"Genre",field:"genre"},{headerName:"Plays",field:"playCount",width:75,suppressSizeToFit:!0}],rowData:null,rowSelection:"multiple",enableColResize:!0,enableSorting:!0,enableFilter:!0,rowDeselection:!0,animateRows:!0,rowClassRules:{"current-track":function(o){return!!e.selectedTrack()&&(t.api.deselectAll(),o.data.id===e.selectedTrack().id)}},getRowNodeId:function(e){return e.id},rowMultiSelectWithClick:!0,onModelUpdated:function(e){e&&e.api&&(e.api.doLayout(),e.api.sizeColumnsToFit())},onRowDoubleClicked:function(o){var n=o.data;if(n){e.tracks=t.tracks;var s=_.findIndex(e.tracks,function(e){return e.id===n.id});e.loadTrack(s),e.$digest()}},onGridReady:function(e){t.api=e.api,t.columnApi=e.columnApi,t.api.showLoadingOverlay()}},t.getArtist=function(){e.isLoggedIn&&e.subsonic.getArtist(o.id).then(function(n){t.artist=n,t.artistName=n.name,e.subsonic.getArtistInfo2(o.id,50).then(function(e){e&&(e.biography&&(t.artistBio=e.biography.replace(/<a\b[^>]*>(.*?)<\/a>/i,"")),e.similarArtist&&(t.similarArtists=e.similarArtist.slice(0,5)),e.largeImageUrl&&$("#mainArtistContent").css("background-image","url("+e.largeImageUrl.replace("300x300","1280x800")+")"),t.$apply())}),n.album&&n.album.length>0?(t.albums=[],t.tracks=[],n.album.forEach(o=>{o.coverArt&&e.subsonic.getCoverArt(o.coverArt,128).then(function(e){o.artUrl=e,t.albums.push(o),t.$apply()}),e.subsonic.getAlbum(o.id).then(function(e){e&&(e.song.forEach(function(e){t.tracks.push(e),t.$apply()}),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.setRowData(t.tracks),t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit()),t.$apply())})})):t.gridOptions.api.showNoRowsOverlay(),t.$apply(),$(".loader").css("display","none"),$(".content").css("display","block")})},t.startRadio=function(){e.subsonic.getSimilarSongs2(o.id).then(function(t){console.log("starting radio"),e.tracks=t.song,e.loadTrack(0),e.$digest()})},t.shuffle=function(){console.log("shuffle play"),e.tracks=_.shuffle(t.tracks),e.loadTrack(0),e.$digest()},e.$on("trackChangedEvent",function(e,o){t.api.redrawRows({force:!0}),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),e.$on("loginStatusChange",function(e,o){console.log("artist reloading on subsonic ready"),t.getArtist()}),e.$on("menuSizeChange",function(e,o){$("#artistsGrid").width($(".wrapper").width()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),e.$on("windowResized",function(e,o){$("#tracksGrid").width($(".wrapper").width()),$("#tracksGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),t.getArtist(),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".content").addClass("content-with-toolbar"),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","$routeParams","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o,n){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("artists-controller");t.gridOptions={columnDefs:[{headerName:"Name",field:"name"},{headerName:"Albums",field:"albumCount",width:150,suppressSizeToFit:!1}],rowData:null,rowSelection:"single",enableColResize:!0,enableSorting:!0,enableFilter:!0,rowDeselection:!0,animateRows:!0,getRowNodeId:function(e){return e.id},rowMultiSelectWithClick:!1,onModelUpdated:function(e){e&&e.api&&(e.api.doLayout(),e.api.sizeColumnsToFit())},onGridReady:function(){console.log("onGridReady"),t.gridOptions.api.sizeColumnsToFit(),t.gridOptions.api.addGlobalListener(function(e){_.debounce(function(){t.gridOptions.api.sizeColumnsToFit()},300)})},onSelectionChanged:function(e){console.log("onSelectionChanged");var n=t.gridOptions.api.getSelectedRows()[0];o.path("/artist/"+n.id.toString()),t.$apply(),console.log("/artist/"+n.id.toString())}},t.getArtists=function(e,t){var o=[];e.forEach(e=>{e.artist.forEach(e=>{o.push(e)})}),Promise.all(o).then(function(e){t(e)})},t.reloadArtists=function(){e.isLoggedIn&&(t.artists=[],e.subsonic.getArtists().then(function(e){t.getArtists(e,function(e){t.artists=e,t.gridOptions.api.setRowData(t.artists),t.gridOptions.api.sizeColumnsToFit(),t.$apply()})}))},e.$on("loginStatusChange",function(e,o){console.log("music reloading on subsonic ready"),t.reloadArtists()}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("#artistsGrid");new agGrid.Grid(e,t.gridOptions)}),e.$on("menuSizeChange",function(e,o){$("#artistsGrid").width($(".wrapper").width()),$("#artistsGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),e.$on("windowResized",function(e,o){$("#artistsGrid").width($(".wrapper").width()),$("#artistsGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),t.reloadArtists(),!0===e.isMenuCollapsed&&($(".content").toggleClass("content-wide"),$(".gridContainer ").toggleClass("dataTable-wide")),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","$location","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o,n){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("genre-controller"),t.artist={},t.albums=[],t.tracks=[],t.artistName="",t.genre=o.id;t.gridOptions={columnDefs:[{headerName:"Artist",field:"artist"},{headerName:"Title",field:"title"},{headerName:"Album",field:"album"},{headerName:"Plays",field:"playCount",width:60,suppressSizeToFit:!0}],rowData:null,rowSelection:"single",enableColResize:!0,enableSorting:!0,enableFilter:!0,rowDeselection:!0,animateRows:!0,getRowNodeId:function(e){return e.id},rowMultiSelectWithClick:!0,onModelUpdated:function(e){e&&e.api&&(e.api.doLayout(),e.api.sizeColumnsToFit())},onSelectionChanged:function(o){var n=t.api.getSelectedRows()[0];e.tracks=t.tracks;var s=_.findIndex(e.tracks,function(e){return e.id===n.id});e.loadTrack(s),e.$digest()},onGridReady:function(e){t.api=e.api,t.columnApi=e.columnApi}},t.getGenre=function(){e.isLoggedIn&&e.subsonic.getSongsByGenre(o.id,500,0).then(function(e){t.tracks=e.song,t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.setRowData(t.tracks),t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit()),t.$apply()})},t.shuffle=function(){console.log("shuffle play"),e.tracks=_.shuffle(t.tracks),e.loadTrack(0),e.$digest()},e.$on("loginStatusChange",function(e,o){console.log("genre reloading on subsonic ready"),t.getGenre()}),e.$on("menuSizeChange",function(e,o){$("#genresGrid").width($(".wrapper").width()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),e.$on("windowResized",function(e,o){$("#genresGrid").width($(".wrapper").width()),$("#genresGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),t.getGenre(),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","$routeParams","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o,n){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("genres-controller"),t.genres=[];t.gridOptions={columnDefs:[{headerName:"Genre",field:"value"},{headerName:"Albums",field:"albumCount"},{headerName:"Songs",field:"songCount"}],rowData:null,rowSelection:"single",enableColResize:!0,enableSorting:!0,enableFilter:!0,rowDeselection:!0,animateRows:!0,getRowNodeId:function(e){return e.value},rowMultiSelectWithClick:!1,onModelUpdated:function(e){e&&e.api&&(e.api.doLayout(),e.api.sizeColumnsToFit())},onGridReady:function(){console.log("onGridReady"),t.gridOptions.api.sizeColumnsToFit(),t.gridOptions.api.addGlobalListener(function(e){_.debounce(function(){t.gridOptions.api.sizeColumnsToFit()},300)})},onSelectionChanged:function(e){console.log("selection changed");var n=t.gridOptions.api.getSelectedRows()[0];o.path("/genre/"+n.value.toString()),t.$apply(),console.log("/genre/"+n.value.toString())}},t.getGenres=function(e,t){var o=[];e.forEach(e=>{e.genre.forEach(e=>{o.push(e)})}),Promise.all(o).then(function(e){t(e)})},t.reloadGenres=function(){e.isLoggedIn&&(t.genres=[],e.subsonic.getGenres().then(function(e){t.genres=e,t.gridOptions.api.setRowData(t.genres),t.gridOptions.api.sizeColumnsToFit(),t.$apply()}))},e.$on("loginStatusChange",function(e,o){console.log("genres reloading on subsonic ready"),t.reloadGenres()}),t.reloadGenres(),!0===e.isMenuCollapsed&&($(".content").toggleClass("content-wide"),$(".gridContainer ").toggleClass("dataTable-wide")),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","$location","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o,n){console.log("home-controller"),$(".content").css("display","none"),$(".loader").css("display","block"),t.processTracks=function(t,o){t.forEach(t=>{t.coverArt&&e.subsonic.getCoverArt(t.coverArt,200).then(function(e){})}),Promise.all([]).then(function(e){o(e)})},t.reloadRandomTracks=function(){e.isLoggedIn&&(t.random=[],e.subsonic.getRandomSongs().then(function(e){t.processTracks(e.song,function(e){t.$apply()})}))},e.$on("loginStatusChange",function(e,o){console.log("home reloading on subsonic ready"),t.reloadRandomTracks()}),e.$on("menuSizeChange",function(e,t){}),e.$on("windowResized",function(e,t){}),t.reloadRandomTracks(),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","chromecastService","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("index-controller"),t.artists=[],t.getArtists=function(e,t){var o=[];e.forEach(e=>{e.artist.forEach(e=>{o.push(e)})}),Promise.all(o).then(function(e){t(e)})},t.reloadArtists=function(){e.isLoggedIn&&(t.artists=[],e.subsonic.getArtists().then(function(e){t.artists=e,t.$apply()}))},e.$on("loginStatusChange",function(e,o){console.log("music reloading on subsonic ready"),t.reloadArtists()}),t.reloadArtists(),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("playing-controller"),t.getSong=function(){e.isLoggedIn&&(e.selectedTrack()&&e.subsonic.getSong(e.selectedTrack().id).then(function(o){t.song=o.song,t.artistName=t.song.artist,t.trackTitle=t.song.title,t.year=t.song.year,t.contentType=t.song.contentType,t.bitrate=t.song.bitrate,t.playCount=t.song.playCount,e.subsonic.getArtistInfo2(t.song.artistId,50).then(function(o){o&&(t.artistBio=o.biography.replace(/<a\b[^>]*>(.*?)<\/a>/i,""),o.similarArtist&&o.similarArtist.length>0&&(t.similarArtists=o.similarArtist),e.setContentBackground(o.largeImageUrl.replace("300x300",Math.round($(".content").width())+"x"+Math.round($(".content").height()))),t.$apply())})}))},e.$on("trackChangedEvent",function(e,o){console.log("Track Changed reloading now playing"),t.getSong()}),e.$on("loginStatusChange",function(e,o){console.log("login changed reloading now playing"),t.getSong()}),t.getSong(),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o,n){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("playlist-controller");t.gridOptions={columnDefs:[{headerName:"Title",field:"title"},{headerName:"Artist",field:"artist"},{headerName:"Album",field:"album"},{headerName:"Title",field:"title"},{headerName:"Genre",field:"genre"},{headerName:"Plays",field:"playCount",width:75,suppressSizeToFit:!0}],rowData:null,rowSelection:"multiple",enableColResize:!0,enableSorting:!0,enableFilter:!0,rowDeselection:!0,animateRows:!0,getRowNodeId:function(e){return e.id},rowMultiSelectWithClick:!0,rowClassRules:{"current-track":function(o){return!!e.selectedTrack()&&(t.api.deselectAll(),o.data.id===e.selectedTrack().id)}},onModelUpdated:function(e){e&&e.api&&(e.api.doLayout(),e.api.sizeColumnsToFit())},onRowDoubleClicked:function(o){if(t.gridOptions&&t.gridOptions.api){var n=o.data;if(n){console.log("selection changed");var s=_.findIndex(e.tracks,function(e){return e.id===n.id});e.loadTrack(s),e.$digest()}}},onGridReady:function(o){t.api=o.api,t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.setRowData(e.tracks),t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}},e.$on("trackChangedEvent",function(e,o){t.api.redrawRows({force:!0}),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),e.$on("loginStatusChange",function(o,n){t.gridOptions.api.setRowData(e.tracks)}),e.$on("menuSizeChange",function(e,o){$("#playlistGrid").width($(".wrapper").width()),$("#playlistGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),e.$on("windowResized",function(e,o){$("#playlistGrid").width($(".wrapper").width()),$("#playlistGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),!0===e.isMenuCollapsed&&($(".content").toggleClass("content-wide"),$(".gridContainer ").toggleClass("dataTable-wide")),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","$sce","subsonicService"],e.exports=n},function(e,t,o){"use strict";function n(e,t,o){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("playlists-controller"),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}n.$inject=["$rootScope","$scope","subsonicService"],e.exports=n},function(e,t){function o(e,t,o){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("podcasts-controller"),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}o.$inject=["$rootScope","$scope","subsonicService"],e.exports=o},function(e,t){function o(e,t,o){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("settings-controller"),t.settings={},t.saveSettings=function(){console.log("save settings"),e.settings.subsonic_address=t.settings.subsonic_address,e.settings.subsonic_port=t.settings.subsonic_port,e.settings.subsonic_use_ssl=t.settings.subsonic_use_ssl,e.settings.subsonic_include_port_in_url=t.settings.subsonic_include_port_in_url,e.settings.subsonic_username=t.settings.subsonic_username,e.settings.subsonic_password=CryptoJS.AES.encrypt(t.settings.subsonic_password,"12345").toString(),e.socket.emit("save_settings",e.settings),o.login()},e.$on("settingsReloadedEvent",function(o,n){console.log("settings reloading"),t.settings.subsonic_address=e.settings.subsonic_address,t.settings.subsonic_port=e.settings.subsonic_port,t.settings.subsonic_use_ssl=!!+e.settings.subsonic_use_ssl,t.settings.subsonic_include_port_in_url=!!+e.settings.subsonic_include_port_in_url,t.settings.subsonic_username=e.settings.subsonic_username,e.settings.subsonic_password&&(t.settings.subsonic_password=CryptoJS.AES.decrypt(e.settings.subsonic_password.toString(),"12345").toString(CryptoJS.enc.Utf8)),t.previewConnectionString()}),t.generateConnectionString=function(){var e="http://";return t.settings.subsonic_use_ssl&&(e="https://"),e+=t.settings.subsonic_address,t.settings.subsonic_include_port_in_url&&(e+=":"+t.settings.subsonic_port),e},t.previewConnectionString=function(){t.connectionStringPreview=t.generateConnectionString(),t.$apply()},e.socket.emit("load_settings"),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}o.$inject=["$rootScope","$scope","subsonicService"],e.exports=o},function(e,t){function o(e,t,o,n,s){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("starred-controller");t.gridOptions={columnDefs:[{headerName:"Id",field:"id",width:75,suppressSizeToFit:!0},{headerName:"#",field:"track",width:75,suppressSizeToFit:!0},{headerName:"Title",field:"title"},{headerName:"Album",field:"album"},{headerName:"Title",field:"title"},{headerName:"Genre",field:"genre"},{headerName:"Plays",field:"playCount",width:75,suppressSizeToFit:!0}],rowData:null,rowSelection:"single",enableColResize:!0,enableSorting:!0,enableFilter:!0,rowDeselection:!0,animateRows:!0,getRowNodeId:function(e){return e.id},rowMultiSelectWithClick:!0,onModelUpdated:function(e){e&&e.api&&(e.api.doLayout(),e.api.sizeColumnsToFit())},onSelectionChanged:function(o){console.log("selection changed");var n=t.api.getSelectedRows()[0];e.tracks=t.tracks;var s=_.findIndex(e.tracks,function(e){return e.id===n.id});e.loadTrack(s),e.$digest()},onGridReady:function(e){t.api=e.api,t.columnApi=e.columnApi}},t.reloadStarred=function(){e.isLoggedIn&&(t.albums=[],t.tracks=[],e.subsonic.getStarred().then(function(o){o.album.forEach(o=>{o.coverArt&&e.subsonic.getCoverArt(o.coverArt,128).then(function(e){o.artUrl=e,t.albums.push(o),t.$apply()})}),t.tracks=o.song,t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.setRowData(t.tracks),t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit()),t.$apply()},function(e){console.log(e)}))},e.$on("loginStatusChange",function(e,o){console.log("starred reloading on subsonic ready"),t.reloadStarred()}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("#starredGrid");new agGrid.Grid(e,t.gridOptions)}),e.$on("menuSizeChange",function(e,o){$("#starredGrid").width($(".wrapper").width()),$("#starredGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),e.$on("windowResized",function(e,o){$("#starredGrid").width($(".wrapper").width()),$("#starredGrid").height($(".wrapper").height()),t.gridOptions&&t.gridOptions.api&&(t.gridOptions.api.doLayout(),t.gridOptions.api.sizeColumnsToFit())}),t.reloadStarred(),!0===e.isMenuCollapsed&&($(".content").toggleClass("content-wide"),$(".gridContainer ").toggleClass("dataTable-wide")),$(".loader").css("display","none"),$(".content").css("display","block")}o.$inject=["$rootScope","$scope","$location","subsonicService"],e.exports=o},function(e,t){function o(e,t,o){$(".content").css("display","none"),$(".loader").css("display","block"),console.log("status-controller"),t.ping=function(){if(e.isLoggedIn){var n=o.ping();n&&n.then(function(e){console.log("ping "+e),t.server=e,t.$apply()})}},t.getUserInfo=function(){e.isLoggedIn&&e.subsonic.getUserInfo().then(function(e){console.log("ping "+e),t.userInfo=e,t.$apply()})},t.getMediaFolders=function(){e.isLoggedIn&&e.subsonic.getMusicFolders().then(function(e){t.folders=e,t.$apply()})},t.startScan=function(){e.isLoggedIn&&e.subsonic.startScan().then(function(e){t.scanStatus=e,t.scanStatusTotalFiles=e.count,t.$apply(),t.rescanInterval=setInterval(function(){t.getScanStatus()},500)})},t.getScanStatus=function(){e.isLoggedIn&&e.subsonic.getScanStatus().then(function(e){t.scanStatus=e,t.scanStatus.count===t.scanStatusTotalFiles&&clearInterval(t.rescanInterval),t.$apply()})},e.$on("loginStatusChange",function(e,o){t.ping(),t.getUserInfo(),t.getMediaFolders()}),t.refreshIntereval=setInterval(function(){t.ping(),t.getUserInfo(),t.getMediaFolders()},5e3),t.$on("$destroy",function(){clearInterval(t.refreshIntereval),clearInterval(t.rescanInterval)}),t.ping(),t.getUserInfo(),t.getMediaFolders(),e.isMenuCollapsed&&$(".content").toggleClass("content-wide"),$(".loader").css("display","none"),$(".content").css("display","block")}o.$inject=["$rootScope","$scope","subsonicService"],e.exports=o}]);